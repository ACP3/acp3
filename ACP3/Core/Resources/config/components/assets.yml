services:
  _defaults:
    autowire: true
    bind:
      $assetRendererStrategyServiceLocator: "@core.assets.renderer.strategy.service_locator"
      $applicationMode: "%core.environment%"
      $systemCache: "@core.cache.system"

  core.assets.event_listener.static_assets_listener:
    class: ACP3\Core\Assets\EventListener\StaticAssetsListener
    tags:
      - { name: core.eventSubscriber }

  core.assets:
    class: ACP3\Core\Assets

  ACP3\Core\Assets: "@core.assets"

  core.assets.cache:
    class: ACP3\Core\Assets\Cache
    arguments:
      $cache: "@core.cache.system"

  tubalmartin\CssMin\Minifier: ~

  core.assets.abstract_minifier:
    class: ACP3\Core\Assets\Renderer\Strategies\AbstractConcatRendererStrategy
    arguments:
      - "@core.assets"
      - "@core.assets.libraries"
      - "@core.environment.application_path"
      - "@core.cache.system"
      - "@core.config"
      - "@core.modules"
      - "@core.assets.file_resolver"
    abstract: true
    deprecated:
      message: "Service %service_id% is deprecated since version 5.12.0. To be removed with version 6.0.0. Use service autowiring instead."

  core.assets.renderer.strategy.css:
    class: ACP3\Core\Assets\Renderer\Strategies\CSSRendererStrategy

  core.assets.renderer.strategy.deferrable_css:
    class: ACP3\Core\Assets\Renderer\Strategies\DeferrableCSSRendererStrategy

  core.assets.renderer.strategy.javascript:
    class: ACP3\Core\Assets\Renderer\Strategies\JavaScriptRendererStrategy

  core.assets.renderer.strategy.concat_css:
    class: ACP3\Core\Assets\Renderer\Strategies\ConcatCSSRendererStrategy

  core.assets.renderer.strategy.concat_deferrable_css:
    class: ACP3\Core\Assets\Renderer\Strategies\ConcatDeferrableCSSRendererStrategy

  core.assets.renderer.strategy.concat_javascript:
    class: ACP3\Core\Assets\Renderer\Strategies\ConcatJavaScriptRendererStrategy

  core.assets.file_resolver:
    class: ACP3\Core\Assets\FileResolver
    arguments:
      $resourcesCache: "@core.assets.cache"

  ACP3\Core\Assets\FileResolver: "@core.assets.file_resolver"

  core.assets.include_js:
    class: ACP3\Core\Assets\IncludeJs

  ACP3\Core\Assets\IncludeJs: "@core.assets.include_js"

  core.assets.include_stylesheet:
    class: ACP3\Core\Assets\IncludeStylesheet

  ACP3\Core\Assets\IncludeStylesheet: "@core.assets.include_stylesheet"

  core.assets.libraries:
    class: ACP3\Core\Assets\Libraries

  ACP3\Core\Assets\Libraries: "@core.assets.libraries"

  core.assets.cache_namespace_libraries:
    class: ACP3\Core\Cache
    arguments:
      $namespace: "libraries"

  core.assets.libraries_cache:
    class: ACP3\Core\Assets\LibrariesCache
    arguments:
      $cache: "@core.assets.cache_namespace_libraries"

  ACP3\Core\Assets\LibrariesCache: "@core.assets.libraries_cache"

  core.assets.page_css_classes:
    class: ACP3\Core\Assets\PageCssClasses

  ACP3\Core\Assets\PageCssClasses: "@core.assets.page_css_classes"

  core.assets.renderer.strategy.service_locator:
    class: Symfony\Component\DependencyInjection\ServiceLocator
    arguments:
      - css_renderer_dev: "@core.assets.renderer.strategy.css"
        css_renderer_prod: "@core.assets.renderer.strategy.concat_css"
        deferrable_css_renderer_dev: "@core.assets.renderer.strategy.deferrable_css"
        deferrable_css_renderer_prod: "@core.assets.renderer.strategy.concat_deferrable_css"
        javascript_renderer_dev: "@core.assets.renderer.strategy.javascript"
        javascript_renderer_prod: "@core.assets.renderer.strategy.concat_javascript"
    tags: ["container.service_locator"]

  core.assets.renderer.css_renderer:
    class: ACP3\Core\Assets\Renderer\CSSRenderer
    factory: ["@core.assets.renderer.css_renderer_factory", "create"]

  ACP3\Core\Assets\Renderer\CSSRenderer: "@core.assets.renderer.css_renderer"

  core.assets.renderer.css_renderer_factory:
    class: ACP3\Core\Assets\Renderer\CSSRendererFactory

  core.assets.renderer.javascript_renderer:
    class: ACP3\Core\Assets\Renderer\JavaScriptRenderer
    factory: ["@core.assets.renderer.javascript_renderer_factory", "create"]

  ACP3\Core\Assets\Renderer\JavaScriptRenderer: "@core.assets.renderer.javascript_renderer"

  core.assets.renderer.javascript_renderer_factory:
    class: ACP3\Core\Assets\Renderer\JavaScriptRendererFactory
