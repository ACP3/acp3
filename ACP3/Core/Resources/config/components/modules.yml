services:
  core.modules:
    class: ACP3\Core\Modules
    arguments:
      - '@core.modules.moduleInfoCache'
    public: true

  ACP3\Core\Modules: '@core.modules'

  core.modules.aclInstaller:
    class: ACP3\Core\Modules\AclInstaller
    public: true
    arguments:
      - '@core.cache.system'
      - '@core.modules.schemaHelper'
      - '@permissions.model.rolerepository'
      - '@permissions.model.rulerepository'
      - '@permissions.model.resourcerepository'
      - '@permissions.model.privilegerepository'

  core.modules.moduleInfoCache:
    class: ACP3\Core\Modules\ModuleInfoCache
    arguments:
      - '@core.cache.system'
      - '@core.xml'
      - '@system.model.modulerepository'

  core.modules.schemaHelper:
    class: ACP3\Core\Modules\SchemaHelper
    public: true
    arguments:
      - '@core.db'
      - '@system.model.modulerepository'
    calls:
      - ['setContainer', ['@service_container']]

  core.modules.installer_logger:
    class: Psr\Log\LoggerInterface
    factory: ['@core.logger.logger_factory', 'create']
    arguments:
      - 'installer'

  core.modules.installer.abstractMigration:
    abstract: true
    arguments:
      - '@core.modules.schemaHelper'

  core.modules.installer.abstractSampleData:
    abstract: true
    arguments:
      - '@core.modules.schemaHelper'

  core.modules.schemaInstaller:
    class: ACP3\Core\Modules\SchemaInstaller
    public: true
    arguments:
      - '@core.modules.installer_logger'
      - '@core.db'
      - '@system.model.modulerepository'
      - '@system.model.settingsrepository'
    calls:
      - ['setContainer', ['@service_container']]

  core.modules.schemaUpdater:
    class: ACP3\Core\Modules\SchemaUpdater
    public: true
    arguments:
      - '@core.modules.schemaHelper'
      - '@system.model.modulerepository'
