{"version":3,"sources":["ACP3/Modules/ACP3/System/Resources/Assets/js/partials/ajax-form.js"],"names":["$","window","document","AjaxForm","element","options","isFormValid","_defaults","targetElement","loadingOverlay","loadingText","customFormData","scrollOffsetElement","settings","extend","_name","init","that","mergeSettings","findSubmitButton","addLoadingLayer","noValidate","on","e","preventDefault","trigger","preValidateForm","processAjaxRequest","prop","removeAllPreviousErrors","checkFormElementsForErrors","data","key","Object","prototype","hasOwnProperty","call","keyStripped","lowerCaseFirstLetter","replace","length","string","charAt","toLowerCase","slice","find","click","closest","removeAttr","attr","form","focusTabWithFirstErrorMessage","scrollToFirstFormError","removeClass","remove","elements","field","nodeName","checkValidity","addErrorDecorationToFormGroup","addErrorMessageToFormField","validationMessage","$elem","addClass","$element","errorMessage","removeErrorMessageFromFormField","append","tabId","tab","focus","hash","$submitButton","$form","hasCustomData","isEmptyObject","processData","FormData","ajax","url","type","toUpperCase","contentType","beforeSend","showLoadingLayer","disableSubmitButton","done","responseData","callback","redirect_url","redirectToNewPage","scrollIntoView","replaceContent","rebindHandlers","location","console","error","fail","jqXHR","status","handleFormErrorMessages","responseText","open","write","close","always","hideLoadingLayer","enableSubmitButton","$loadingLayer","$body","appendTo","href","reload","offsetTop","offset","top","scrollTop","animate","html","$bindingTarget","formSubmit","errorMessagesHtml","$errorBox","$modalBody","hide","prependTo","is","fadeIn","prettyPrintResponseErrorMessages","each","index","$this","errorClass","filter","$formErrors","isElementInViewport","$scrollOffsetElement","height","jQuery","rect","getBoundingClientRect","left","bottom","innerHeight","documentElement","clientHeight","right","innerWidth","clientWidth","fn","target"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) by the ACP3 Developers.\n * See the LICENSE file at the top-level module directory for licencing details.\n */\n\n(($, window, document) => {\n    'use strict';\n\n    const pluginName = 'formSubmit';\n\n    class AjaxForm {\n        constructor(element, options) {\n            this.element = element;\n            this.isFormValid = true;\n\n            this._defaults = {\n                targetElement: '#content',\n                loadingOverlay: true,\n                loadingText: '',\n                customFormData: null,\n                scrollOffsetElement: null\n            };\n            this.settings = $.extend({}, this._defaults, options);\n            this._name = pluginName;\n            this.init();\n        }\n\n        init() {\n            const that = this;\n\n            this.mergeSettings();\n            this.findSubmitButton();\n            this.addLoadingLayer();\n            this.element.noValidate = true;\n\n            $(this.element).on('submit', (e) => {\n                e.preventDefault();\n\n                this.isFormValid = true;\n\n                $(document).trigger('acp3.ajaxFrom.submit.before', [this]);\n\n                if (this.isFormValid && this.preValidateForm(this.element)) {\n                    this.processAjaxRequest();\n                }\n            }).on('click', function (e) {\n                if ($(this).prop('tagName') === 'A') {\n                    e.preventDefault();\n\n                    that.processAjaxRequest();\n                }\n            }).on('change', () => {\n                if (this.isFormValid === false) {\n                    this.removeAllPreviousErrors();\n                    this.checkFormElementsForErrors(this.element);\n                }\n            });\n        }\n\n        mergeSettings() {\n            const data = $(this.element).data();\n            for (let key in data) {\n                if (Object.prototype.hasOwnProperty.call(data, key)) {\n                    const keyStripped = this.lowerCaseFirstLetter(key.replace('ajaxForm', ''));\n\n                    if (keyStripped.length > 0 && typeof this.settings[keyStripped] !== 'undefined') {\n                        this.settings[keyStripped] = data[key];\n                    }\n                }\n            }\n        }\n\n        lowerCaseFirstLetter(string) {\n            return string.charAt(0).toLowerCase() + string.slice(1);\n        }\n\n        findSubmitButton() {\n            $(this.element).find(':submit').click(function () {\n                $(':submit', $(this).closest('form')).removeAttr('data-clicked');\n                $(this).attr('data-clicked', 'true');\n            });\n        }\n\n        preValidateForm(form) {\n            this.removeAllPreviousErrors();\n            this.checkFormElementsForErrors(form);\n            this.focusTabWithFirstErrorMessage();\n            this.scrollToFirstFormError();\n\n            return this.isFormValid;\n        }\n\n        removeAllPreviousErrors() {\n            $('form .form-group.has-error')\n                .removeClass('has-error')\n                .find('.validation-failed').remove();\n        }\n\n        checkFormElementsForErrors(form) {\n            for (const field of form.elements) {\n                if (field.nodeName !== 'INPUT' && field.nodeName !== 'TEXTAREA' && field.nodeName !== 'SELECT') {\n                    continue;\n                }\n\n                if (!field.checkValidity()) {\n                    this.addErrorDecorationToFormGroup($(field));\n                    this.addErrorMessageToFormField($(field), field.validationMessage);\n\n                    this.isFormValid = false;\n                }\n            }\n        }\n\n        addErrorDecorationToFormGroup($elem) {\n            $elem.closest('.form-group').addClass('has-error');\n        }\n\n        removeErrorMessageFromFormField($elem) {\n            $elem.closest('div').find('.validation-failed').remove();\n        }\n\n        addErrorMessageToFormField($element, errorMessage) {\n            this.removeErrorMessageFromFormField($element);\n\n            $element\n                .closest('div:not(.input-group):not(.btn-group)')\n                .append('<small class=\"help-block validation-failed\"><i class=\"fas fa-exclamation-circle\"></i> ' + errorMessage + '</small>'\n                );\n        }\n\n        focusTabWithFirstErrorMessage() {\n            if ($('.tabbable').length > 0) {\n                let $elem = $('.tabbable .form-group.has-error:first'),\n                    tabId = $elem.closest('.tab-pane').prop('id');\n                $('.tabbable .nav-tabs a[href=\"#' + tabId + '\"]').tab('show');\n\n                $elem.find(':input').focus();\n            }\n        }\n\n        processAjaxRequest() {\n            const $form = $(this.element),\n                hasCustomData = !$.isEmptyObject(this.settings.customFormData);\n\n            let hash,\n                processData = true,\n                data = this.settings.customFormData || {},\n                $submitButton;\n\n            if ($form.attr('method')) {\n                $submitButton = $(':submit[data-clicked=\"true\"]', $form);\n\n                hash = $submitButton.data('hashChange');\n\n                data = new FormData($form[0]);\n\n                if ($submitButton.length) {\n                    data.append($submitButton.attr('name'), 1);\n                }\n\n                if (hasCustomData) {\n                    for (let key in this.settings.customFormData) {\n                        if (Object.prototype.hasOwnProperty.call(this.settings.customFormData, key)) {\n                            data.append(key, this.settings.customFormData[key]);\n                        }\n                    }\n                }\n\n                processData = false;\n            } else {\n                hash = $form.data('hashChange');\n            }\n\n            $.ajax({\n                url: $form.attr('action') || $form.attr('href'),\n                type: $form.attr('method') ? $form.attr('method').toUpperCase() : 'GET',\n                data: data,\n                processData: processData,\n                contentType: processData ? 'application/x-www-form-urlencoded; charset=UTF-8' : false,\n                beforeSend: () => {\n                    this.showLoadingLayer($submitButton);\n                    this.disableSubmitButton($submitButton);\n                }\n            }).done((responseData) => {\n                try {\n                    let callback = $form.data('ajax-form-complete-callback');\n\n                    if (typeof window[callback] === 'function') {\n                        window[callback](responseData);\n                    } else if (responseData.redirect_url) {\n                        this.redirectToNewPage(hash, responseData);\n                    } else {\n                        this.scrollIntoView();\n                        this.replaceContent(hash, responseData);\n                        this.rebindHandlers(hash);\n\n                        $(document).trigger('acp3.ajaxFrom.complete');\n\n                        if (typeof hash !== 'undefined') {\n                            window.location.hash = hash;\n                        }\n                    }\n                } catch (e) {\n                    console.error(e);\n                }\n            }).fail((jqXHR) => {\n                if (jqXHR.status === 400) {\n                    this.handleFormErrorMessages($form, jqXHR.responseText);\n                    this.scrollToFirstFormError();\n\n                    $(document).trigger('acp3.ajaxFrom.submit.fail', [this]);\n                } else if (jqXHR.responseText.length > 0) {\n                    document.open();\n                    document.write(jqXHR.responseText);\n                    document.close();\n                }\n            }).always(() => {\n                this.hideLoadingLayer();\n                this.enableSubmitButton($submitButton);\n            });\n        }\n\n        addLoadingLayer() {\n            if (this.settings.loadingOverlay === false) {\n                return;\n            }\n\n            const $loadingLayer = $('#loading-layer');\n\n            if ($loadingLayer.length === 0) {\n                const $body = $('body'),\n                    loadingText = this.settings.loadingText || '',\n                    html = '<div id=\"loading-layer\" class=\"loading-layer\"><h1><span class=\"fas fa-spinner fa-spin\"></span> ' + loadingText + '</h1></div>';\n\n                $(html).appendTo($body);\n            }\n        }\n\n        showLoadingLayer() {\n            $('#loading-layer').addClass('loading-layer__active');\n        }\n\n        disableSubmitButton($submitButton) {\n            if (typeof $submitButton !== 'undefined') {\n                $submitButton.prop('disabled', true);\n            }\n        }\n\n        enableSubmitButton($submitButton) {\n            if (typeof $submitButton !== 'undefined') {\n                $submitButton.prop('disabled', false);\n            }\n        }\n\n        redirectToNewPage(hash, responseData) {\n            if (typeof hash !== 'undefined') {\n                window.location.href = responseData.redirect_url + hash;\n                window.location.reload();\n            } else {\n                window.location.href = responseData.redirect_url;\n            }\n        }\n\n        /**\n         * Scroll to the beginning of the content area, if the current viewport is near the bottom\n         */\n        scrollIntoView() {\n            const offsetTop = $(this.settings.targetElement).offset().top;\n\n            if ($(document).scrollTop() > offsetTop) {\n                $('html, body').animate(\n                    {\n                        scrollTop: offsetTop\n                    },\n                    'fast'\n                );\n            }\n        }\n\n        replaceContent(hash, responseData) {\n            if (hash && $(hash).length) {\n                $(hash).html($(responseData).find(hash).html());\n            } else {\n                $(this.settings.targetElement).html(responseData);\n            }\n        }\n\n        rebindHandlers(hash) {\n            const $bindingTarget = (hash && $(hash).length) ? $(hash) : $(this.settings.targetElement);\n\n            $bindingTarget.find('[data-ajax-form=\"true\"]').formSubmit();\n\n            this.findSubmitButton();\n        }\n\n        hideLoadingLayer() {\n            $('#loading-layer').removeClass('loading-layer__active');\n        }\n\n        handleFormErrorMessages($form, errorMessagesHtml) {\n            let $errorBox = $('#error-box');\n            const $modalBody = $form.find('.modal-body');\n\n            $errorBox.remove();\n\n            // Place the error messages inside the modal body for a better styling\n            $errorBox = $(errorMessagesHtml);\n\n            $errorBox\n                .hide()\n                .prependTo(($modalBody.length > 0 && $modalBody.is(':visible')) ? $modalBody : $form)\n                .fadeIn();\n\n            this.prettyPrintResponseErrorMessages($form, $errorBox);\n        }\n\n        prettyPrintResponseErrorMessages($form, $errorBox) {\n            this.removeAllPreviousErrors();\n\n            // highlight all input fields where the validation has failed\n            $errorBox.find('li').each((index, element) => {\n                let $this = $(element),\n                    errorClass = $this.data('error');\n\n                if (errorClass.length > 0) {\n                    let $elem = $form.find('#' + errorClass) || $form.find('[id|=\"' + errorClass + '\"]').filter(':not([id$=\"container\"])');\n\n                    if ($elem.length > 0) {\n                        this.addErrorDecorationToFormGroup($elem);\n\n                        // Move the error message to the responsible input field(s)\n                        // and remove the list item from the error box container\n                        if ($elem.length === 1) {\n                            this.addErrorMessageToFormField($elem, $this.html());\n                            $this.remove();\n                        }\n                    }\n                }\n            });\n\n            // if all list items have been removed, remove the error box container too\n            if ($errorBox.find('li').length === 0) {\n                $errorBox.remove();\n            }\n\n            this.focusTabWithFirstErrorMessage();\n        }\n\n        scrollToFirstFormError() {\n            const $form = $(this.element);\n            const $formErrors = $form.find('.form-group.has-error');\n\n            if ($form.closest('.modal').length > 0) {\n                return;\n            }\n\n            if (!$formErrors || $formErrors.length === 0) {\n                return;\n            }\n\n            if (this.isElementInViewport($form.find('.help-block.validation-failed'))) {\n                return;\n            }\n\n            let offsetTop = $formErrors.offset().top;\n\n            if (this.settings.scrollOffsetElement) {\n                const $scrollOffsetElement = $(this.settings.scrollOffsetElement);\n\n                if ($scrollOffsetElement && $scrollOffsetElement.length > 0) {\n                    offsetTop -= $scrollOffsetElement.height();\n                }\n            }\n\n            $('html, body').animate(\n                {\n                    scrollTop: offsetTop\n                },\n                'fast'\n            );\n        }\n\n        isElementInViewport(element) {\n            // special bonus for those using jQuery\n            if (typeof jQuery === 'function' && element instanceof jQuery) {\n                element = element[0];\n            }\n\n            const $scrollOffsetElement = $(this.settings.scrollOffsetElement);\n            let offsetTop = 0;\n\n            if ($scrollOffsetElement) {\n                offsetTop = $scrollOffsetElement.height();\n            }\n\n            const rect = element.getBoundingClientRect();\n\n            return rect.top >= offsetTop\n                && rect.left >= 0\n                && rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)\n                && rect.right <= (window.innerWidth || document.documentElement.clientWidth);\n        }\n    }\n\n    $.fn[pluginName] = function (options) {\n        return this.each(function () {\n            if (!$.data(this, 'plugin_' + pluginName)) {\n                $.data(this, 'plugin_' + pluginName, new AjaxForm(this, options));\n            }\n        });\n    };\n})(jQuery, window, document);\n\n(($) => {\n    $('[data-ajax-form=\"true\"]').formSubmit();\n\n    $(document).on('draw.dt', (e) => {\n        $(e.target).find('[data-ajax-form=\"true\"]').formSubmit();\n    });\n})(jQuery);\n"],"file":"ajax-form.min.js"}