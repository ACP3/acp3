!function(){var e={};Object.defineProperty(e,"__esModule",{value:!0}),e.mergeSettings=function(e,t,o){const r={...e,...t};if(!o)return r;for(let[a,s]of Object.entries(o)){const e=(i=a.replace("ajaxForm","")).charAt(0).toLowerCase()+i.slice(1);if(e.length>0&&void 0!==r[e])try{r[e]=JSON.parse(s)}catch(n){r[e]=s}}var i;return r},e.addScriptsToHead=function(e){for(const t of e.getElementsByTagName("script")){const e=document.createElement("script");t.src?e.src=t.src:e.innerHTML=t.innerHTML,document.head.appendChild(e)}};var t={};Object.defineProperty(t,"__esModule",{value:!0}),t.delegateEvent=function(e,t,o,r){e.addEventListener(t,e=>{if("string"==typeof o){const t=document.querySelectorAll(o);if(!t)return;t.forEach(t=>{t&&t.contains(e.target)&&r(e,t)})}else o&&o.contains(e.target)&&r(e,o)})};var o={};function r(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}Object.defineProperty(o,"__esModule",{value:!0}),o.AjaxForm=void 0;var i=0;function n(e){return"__private_"+i+++"_"+e}var a=n("loadingIndicator"),s=n("formValidator"),l=n("defaults"),c=n("init"),d=n("registerClickedSubmitButton"),u=n("prepareFormData"),h=n("handleResponseError"),m=n("handleSuccessfulResponse"),f=n("disableSubmitButton"),v=n("enableSubmitButton"),p=n("decodeResponse"),g=n("redirectToNewPage"),y=n("scrollIntoView"),b=n("replaceContent");function w(){r(this,d)[d](),(0,t.delegateEvent)(document,"click",'a[data-ajax-form="true"]',async(e,t)=>{e.preventDefault(),await this.performAjaxRequest(t)}),(0,t.delegateEvent)(document,"submit",'form[data-ajax-form="true"]',async(e,t)=>{e.preventDefault(),r(this,s)[s].setFormAsValid(t),document.dispatchEvent(new CustomEvent("acp3.ajaxFrom.submit.before",{detail:this})),r(this,s)[s].isValid(t)&&r(this,s)[s].preValidateForm(t)&&await this.performAjaxRequest(t)}),(0,t.delegateEvent)(document,"change",'form[data-ajax-form="true"]',async(e,t)=>{!1===r(this,s)[s].isValid(t)&&r(this,s)[s].checkFormElementsForErrors(t)})}function E(){(0,t.delegateEvent)(document,"click",'form[data-ajax-form="true"] [type="submit"]',(e,t)=>{t.closest("form").querySelectorAll("[type=submit]").forEach(e=>{delete e.dataset.clicked}),t.dataset.clicked="true"})}function j(e,t,o){const r=o.customFormData||{};let i;e.getAttribute("method")?(i=new FormData(e),t&&i.append(t.getAttribute("name"),"1")):i=new FormData;for(let[n,a]of Object.entries(r))i.append(n,a);return i}async function O(e,t){const o=await e.clone().text();400===e.status?(r(this,s)[s].handleFormErrorMessages(t,o),document.dispatchEvent(new CustomEvent("acp3.ajaxFrom.submit.fail",{detail:this}))):o.length>0&&(document.open(),document.write(o),document.close())}async function F(e,t,o){const i=await r(this,p)[p](e);"function"==typeof window[o.completeCallback]?window[o.completeCallback](i):i.redirect_url?r(this,g)[g](t,i):(r(this,b)[b](t,i,o),r(this,y)[y](t,o),void 0!==t&&(window.location.hash=t),document.dispatchEvent(new CustomEvent("acp3.ajaxFrom.complete")))}function S(e){e&&(e.disabled=!0)}function P(e){e&&(e.disabled=!1)}async function T(e){try{return await e.clone().json()}catch(t){return await e.clone().text()}}function q(e,t){void 0!==e?(window.location.href=t.redirect_url+e,window.location.reload()):window.location.href=t.redirect_url}function _(e,t){setTimeout(()=>{if(e){const t=document.querySelector('[data-hash-change="'.concat(e,'"]'));window.scrollTo({top:t.getBoundingClientRect().y,behavior:"smooth"})}else{const e=document.querySelector(t.targetElement).getBoundingClientRect().y;document.scrollTop>e&&window.scrollTo({top:e,behavior:"smooth"})}})}function A(t,o,r){let i,n;if(t&&document.querySelector(t)){const e=(new DOMParser).parseFromString(o,"text/html");i=document.querySelector(t),n=e.querySelector(t).innerHTML}else i=document.querySelector(r.targetElement),n=o;i.innerHTML=n,(0,e.addScriptsToHead)(i)}o.AjaxForm=class{constructor(e,t){Object.defineProperty(this,b,{value:A}),Object.defineProperty(this,y,{value:_}),Object.defineProperty(this,g,{value:q}),Object.defineProperty(this,p,{value:T}),Object.defineProperty(this,v,{value:P}),Object.defineProperty(this,f,{value:S}),Object.defineProperty(this,m,{value:F}),Object.defineProperty(this,h,{value:O}),Object.defineProperty(this,u,{value:j}),Object.defineProperty(this,d,{value:E}),Object.defineProperty(this,c,{value:w}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,s,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:{completeCallback:null,targetElement:"#content",loadingOverlay:!0,customFormData:null,method:null}}),r(this,a)[a]=e,r(this,s)[s]=t,r(this,c)[c]()}async performAjaxRequest(t){const o=(0,e.mergeSettings)(r(this,l)[l],{},t.dataset);let i,n;var s;i=t instanceof HTMLFormElement?null===(s=n=t.querySelector('[type="submit"][data-clicked="true"]'))||void 0===s?void 0:s.dataset.hashChange:t.dataset.hashChange,o.loadingOverlay&&(r(this,a)[a].addLoadingIndicator(n||t),r(this,a)[a].showLoadingIndicator(n||t)),r(this,f)[f](n);try{var c,d,p,g;const e=null!==(c=null!==(d=null===(p=t.getAttribute("method"))||void 0===p?void 0:p.toUpperCase())&&void 0!==d?d:null===(g=o.method)||void 0===g?void 0:g.toUpperCase())&&void 0!==c?c:"GET",s=await fetch(t.getAttribute("action")||t.getAttribute("href"),{method:e,body:"GET"!==e?r(this,u)[u](t,n,o):null,headers:{"X-Requested-With":"XMLHttpRequest"}});s.ok?await r(this,m)[m](s,i,o):await r(this,h)[h](s,t)}catch(y){console.error(y)}finally{r(this,a)[a].hideLoadingIndicator(n||t),r(this,v)[v](n)}}};var L={};function M(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}Object.defineProperty(L,"__esModule",{value:!0}),L.LoadingIndicator=void 0;var V=0;var x="__private_"+V+++"_"+"toggleLoadingIndicator";function C(e,t){var o;null===(o=e.querySelector(".loading-indicator"))||void 0===o||o.classList.toggle("loading-indicator__active",t)}L.LoadingIndicator=class{constructor(){Object.defineProperty(this,x,{value:C})}addLoadingIndicator(e){if(!e.querySelector(".loading-indicator")){const t=document.querySelector("body"),o='<svg class="svg-icon svg-icon__spinner svg-icon--spin loading-indicator" fill="currentColor"><use xlink:href="'+JSON.parse(t.dataset.svgIcons).loadingIndicatorIcon+'"></use></svg>';e.insertAdjacentHTML("afterbegin",o)}}showLoadingIndicator(e){M(this,x)[x](e,!0)}hideLoadingIndicator(e){M(this,x)[x](e,!1)}};var I={};function k(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}Object.defineProperty(I,"__esModule",{value:!0}),I.FormValidator=void 0;var H=0;function R(e){return"__private_"+H+++"_"+e}var B=R("defaults"),D=R("settings"),N=R("removeAllPreviousErrors"),W=R("removeErrorMessageFromFormField"),U=R("addErrorMessageToFormField"),X=R("focusTabWithFirstErrorMessage"),G=R("prettyPrintResponseErrorMessages"),J=R("scrollToFirstFormError"),z=R("isElementInViewport");function K(e){e.querySelectorAll(".is-invalid").forEach(e=>{e.classList.remove("is-invalid")})}function Q(e){var t,o;null===(t=e.closest("div"))||void 0===t||null===(o=t.querySelector(".invalid-feedback"))||void 0===o||o.remove()}function Y(e,t){k(this,W)[W](e),e.classList.add("is-invalid"),e.closest("div:not(.input-group):not(.btn-group)").insertAdjacentHTML("beforeend",'<div class="invalid-feedback">'.concat(t,"</div>"))}function Z(e){if(!e.querySelector(".nav-tabs"))return;const t=e.querySelector(".is-invalid");if(!t)return;const o=t.closest(".tab-pane").getAttribute("id");e.querySelector('.nav-tabs a[href="#'+o+'"]').click(),t.focus()}function $(e,t){k(this,N)[N](e),t.querySelectorAll("li").forEach(t=>{let o=t.dataset.element;if(o.length>0){let r=document.getElementById(o)||e.querySelector('[id|="'+o+'"]');r&&(k(this,U)[U](r[0],t.innerHTML),t.remove())}}),0===t.querySelectorAll("li").length&&t.remove(),k(this,X)[X](e),k(this,J)[J](e)}function ee(e){var t;if((null===(t=e.closest(".modal"))||void 0===t?void 0:t.length)>0)return;const o=e.querySelectorAll(".is-invalid");if(!o||0===o.length)return;if(k(this,z)[z](e.querySelector(".invalid-feedback")))return;let r=o.item(0).getBoundingClientRect().top;if(k(this,D)[D].scrollOffsetElement){const e=document.querySelector(k(this,D)[D].scrollOffsetElement);e&&(r-=e.clientHeight)}window.scrollTo({top:r,behavior:"smooth"})}function te(e){const t=document.querySelector(k(this,D)[D].scrollOffsetElement);let o=0;t&&(o=t.clientHeight);const r=e.getBoundingClientRect();return r.top>=o&&r.left>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&r.right<=(window.innerWidth||document.documentElement.clientWidth)}I.FormValidator=class{constructor(t={}){Object.defineProperty(this,z,{value:te}),Object.defineProperty(this,J,{value:ee}),Object.defineProperty(this,G,{value:$}),Object.defineProperty(this,X,{value:Z}),Object.defineProperty(this,U,{value:Y}),Object.defineProperty(this,W,{value:Q}),Object.defineProperty(this,N,{value:K}),Object.defineProperty(this,B,{writable:!0,value:{scrollOffsetElement:null}}),Object.defineProperty(this,D,{writable:!0,value:void 0}),k(this,D)[D]=(0,e.mergeSettings)(k(this,B)[B],t,{})}preValidateForm(e){return this.checkFormElementsForErrors(e),k(this,X)[X](e),k(this,J)[J](e),this.isValid(e)}checkFormElementsForErrors(e){k(this,N)[N](e);for(const t of e.elements)"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||t.checkValidity()||(k(this,U)[U](t,t.validationMessage),e.formValidator.isValid=!1)}isValid(e){var t;return!(null===(t=e.formValidator)||void 0===t||!t.isValid)}setFormAsValid(e){e.formValidator={isValid:!0}}handleFormErrorMessages(e,t){var o;if(!(e instanceof HTMLFormElement))return;const r=e.querySelector(".modal-body");null===(o=document.getElementById("error-box"))||void 0===o||o.remove(),r?r.insertAdjacentHTML("afterbegin",t):e.insertAdjacentHTML("afterbegin",t),k(this,G)[G](e,document.getElementById("error-box"))}},new o.AjaxForm(new L.LoadingIndicator,new I.FormValidator)}();
//# sourceMappingURL=ajax-form.min.js.map
