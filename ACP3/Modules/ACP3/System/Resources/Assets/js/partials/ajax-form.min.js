!function(){"use strict";function e(e,t,o){const r={...e,...t};if(!o)return r;for(let[e,t]of Object.entries(o)){const o=(n=e.replace("ajaxForm","")).charAt(0).toLowerCase()+n.slice(1);if(o.length>0&&void 0!==r[o])try{r[o]=JSON.parse(t)}catch{r[o]=t}}var n;return r}function t(e,t,o,r){e.addEventListener(t,(e=>{if("string"==typeof o){const t=document.querySelectorAll(o);if(!t)return;t.forEach((t=>{t&&t.contains(e.target)&&r(e,t)}))}else o&&o.contains(e.target)&&r(e,o)}))}function o(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var r=0;function n(e){return"__private_"+r+++"_"+e}var i=n("loadingIndicator"),a=n("formValidator"),s=n("defaults"),c=n("init"),l=n("registerClickedSubmitButton"),d=n("prepareFormData"),u=n("handleResponseError"),h=n("handleSuccessfulResponse"),m=n("disableSubmitButton"),f=n("enableSubmitButton"),v=n("decodeResponse"),p=n("redirectToNewPage"),y=n("scrollIntoView"),b=n("replaceContent");class g{constructor(e,t){Object.defineProperty(this,b,{value:L}),Object.defineProperty(this,y,{value:A}),Object.defineProperty(this,p,{value:T}),Object.defineProperty(this,v,{value:q}),Object.defineProperty(this,f,{value:P}),Object.defineProperty(this,m,{value:F}),Object.defineProperty(this,h,{value:S}),Object.defineProperty(this,u,{value:O}),Object.defineProperty(this,d,{value:j}),Object.defineProperty(this,l,{value:E}),Object.defineProperty(this,c,{value:w}),Object.defineProperty(this,i,{writable:!0,value:void 0}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,s,{writable:!0,value:{completeCallback:null,targetElement:"#content",loadingOverlay:!0,customFormData:null,method:null}}),o(this,i)[i]=e,o(this,a)[a]=t,o(this,c)[c]()}async performAjaxRequest(t){const r=e(o(this,s)[s],{},t.dataset);let n,a;var c;t instanceof HTMLFormElement?(a=t.querySelector('[type="submit"][data-clicked="true"]'),n=null===(c=a)||void 0===c?void 0:c.dataset.hashChange):n=t.dataset.hashChange;r.loadingOverlay&&(o(this,i)[i].addLoadingIndicator(a||t),o(this,i)[i].showLoadingIndicator(a||t)),o(this,m)[m](a);try{var l,v,p,y;const e=null!==(l=null!==(v=null===(p=t.getAttribute("method"))||void 0===p?void 0:p.toUpperCase())&&void 0!==v?v:null===(y=r.method)||void 0===y?void 0:y.toUpperCase())&&void 0!==l?l:"GET",s=await fetch(t.getAttribute("action")||t.getAttribute("href"),{method:e,body:"GET"!==e?o(this,d)[d](t,a,r):null,headers:{"X-Requested-With":"XMLHttpRequest"}});s.ok?await o(this,h)[h](s,n,r):await o(this,u)[u](s,t)}catch(e){console.error(e)}finally{o(this,i)[i].hideLoadingIndicator(a||t),o(this,f)[f](a)}}}function w(){o(this,l)[l](),t(document,"click",'a[data-ajax-form="true"]',(async(e,t)=>{e.preventDefault(),await this.performAjaxRequest(t)})),t(document,"submit",'form[data-ajax-form="true"]',(async(e,t)=>{e.preventDefault(),o(this,a)[a].setFormAsValid(t),document.dispatchEvent(new CustomEvent("acp3.ajaxFrom.submit.before",{detail:this})),o(this,a)[a].isValid(t)&&o(this,a)[a].preValidateForm(t)&&await this.performAjaxRequest(t)})),t(document,"change",'form[data-ajax-form="true"]',(async(e,t)=>{!1===o(this,a)[a].isValid(t)&&o(this,a)[a].checkFormElementsForErrors(t)}))}function E(){t(document,"click",'form[data-ajax-form="true"] [type="submit"]',((e,t)=>{t.closest("form").querySelectorAll("[type=submit]").forEach((e=>{delete e.dataset.clicked})),t.dataset.clicked="true"}))}function j(e,t,o){const r=o.customFormData||{};let n;e.getAttribute("method")?(n=new FormData(e),t&&n.append(t.getAttribute("name"),"1")):n=new FormData;for(let[e,t]of Object.entries(r))n.append(e,t);return n}async function O(e,t){const r=await e.clone().text();400===e.status?(o(this,a)[a].handleFormErrorMessages(t,r),document.dispatchEvent(new CustomEvent("acp3.ajaxFrom.submit.fail",{detail:this}))):r.length>0&&(document.open(),document.write(r),document.close())}async function S(e,t,r){const n=await o(this,v)[v](e);"function"==typeof window[r.completeCallback]?window[r.completeCallback](n):n.redirect_url?o(this,p)[p](t,n):(o(this,b)[b](t,n,r),o(this,y)[y](t,r),void 0!==t&&(window.location.hash=t),document.dispatchEvent(new CustomEvent("acp3.ajaxFrom.complete")))}function F(e){e&&(e.disabled=!0)}function P(e){e&&(e.disabled=!1)}async function q(e){try{return await e.clone().json()}catch(t){return await e.clone().text()}}function T(e,t){void 0!==e?(window.location.href=t.redirect_url+e,window.location.reload()):window.location.href=t.redirect_url}function A(e,t){setTimeout((()=>{if(e){const t=document.querySelector('[data-hash-change="'.concat(e,'"]'));window.scrollTo({top:t.getBoundingClientRect().y,behavior:"smooth"})}else{const e=document.querySelector(t.targetElement).getBoundingClientRect().y;document.scrollTop>e&&window.scrollTo({top:e,behavior:"smooth"})}}))}function L(e,t,o){let r,n;if(e&&document.querySelector(e)){const o=(new DOMParser).parseFromString(t,"text/html");r=document.querySelector(e),n=o.querySelector(e).innerHTML}else r=document.querySelector(o.targetElement),n=t;r.innerHTML=n,function(e){for(const t of e.getElementsByTagName("script")){const e=document.createElement("script");t.src?e.src=t.src:e.innerHTML=t.innerHTML,document.head.appendChild(e)}}(r)}function M(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var V=0;function C(e){return"__private_"+V+++"_"+e}var k=C("toggleLoadingIndicator");class I{constructor(){Object.defineProperty(this,k,{value:_})}addLoadingIndicator(e){if(!e.querySelector(".loading-indicator")){const t=document.querySelector("body"),o=JSON.parse(t.dataset.svgIcons);e.insertAdjacentHTML("afterbegin",o.loadingIndicatorIcon)}}showLoadingIndicator(e){M(this,k)[k](e,!0)}hideLoadingIndicator(e){M(this,k)[k](e,!1)}}function _(e,t){var o;null===(o=e.querySelector(".loading-indicator"))||void 0===o||o.classList.toggle("loading-indicator__active",t)}function x(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var H=0;function R(e){return"__private_"+H+++"_"+e}var B=R("defaults"),D=R("settings"),N=R("removeAllPreviousErrors"),W=R("removeErrorMessageFromFormField"),U=R("addErrorMessageToFormField"),X=R("focusTabWithFirstErrorMessage"),G=R("prettyPrintResponseErrorMessages"),J=R("scrollToFirstFormError"),z=R("isElementInViewport");class K{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.defineProperty(this,z,{value:oe}),Object.defineProperty(this,J,{value:te}),Object.defineProperty(this,G,{value:ee}),Object.defineProperty(this,X,{value:$}),Object.defineProperty(this,U,{value:Z}),Object.defineProperty(this,W,{value:Y}),Object.defineProperty(this,N,{value:Q}),Object.defineProperty(this,B,{writable:!0,value:{scrollOffsetElement:null}}),Object.defineProperty(this,D,{writable:!0,value:void 0}),x(this,D)[D]=e(x(this,B)[B],t,{})}preValidateForm(e){return this.checkFormElementsForErrors(e),x(this,X)[X](e),x(this,J)[J](e),this.isValid(e)}checkFormElementsForErrors(e){x(this,N)[N](e);for(const t of e.elements)"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||t.checkValidity()||(x(this,U)[U](t,t.validationMessage),e.formValidator||(e.formValidator={}),e.formValidator.isValid=!1)}isValid(e){var t;return!(null===(t=e.formValidator)||void 0===t||!t.isValid)}setFormAsValid(e){e.formValidator={isValid:!0}}handleFormErrorMessages(e,t){var o;if(!(e instanceof HTMLFormElement))return;const r=e.querySelector(".modal-body");null===(o=document.getElementById("error-box"))||void 0===o||o.remove(),e.closest(".modal")&&r?r.insertAdjacentHTML("afterbegin",t):e.insertAdjacentHTML("afterbegin",t),x(this,G)[G](e,document.getElementById("error-box"))}}function Q(e){e.querySelectorAll(".is-invalid").forEach((e=>{e.classList.remove("is-invalid")}))}function Y(e){var t,o;null===(t=e.closest("div"))||void 0===t||null===(o=t.querySelector(".invalid-feedback"))||void 0===o||o.remove()}function Z(e,t){x(this,W)[W](e),e.classList.add("is-invalid"),e.closest("div:not(.input-group):not(.btn-group)").insertAdjacentHTML("beforeend",'<div class="invalid-feedback">'.concat(t,"</div>"))}function $(e){if(!e.querySelector(".nav-tabs"))return;const t=e.querySelector(".is-invalid");if(!t)return;const o=t.closest(".tab-pane").getAttribute("id");e.querySelector('.nav-tabs a[href="#'+o+'"]').click(),t.focus()}function ee(e,t){x(this,N)[N](e),t.querySelectorAll("li").forEach((t=>{let o=t.dataset.element;if((null==o?void 0:o.length)>0){let r=document.getElementById(o)||e.querySelector('[id|="'+o+'"]');r&&(x(this,U)[U](r[0],t.innerHTML),t.remove())}})),0===t.querySelectorAll("li").length&&t.remove(),x(this,X)[X](e),x(this,J)[J](e)}function te(e){var t;if((null===(t=e.closest(".modal"))||void 0===t?void 0:t.length)>0)return;const o=e.querySelectorAll(".is-invalid");if(!o||0===o.length)return;if(x(this,z)[z](e.querySelector(".invalid-feedback")))return;let r=o.item(0).getBoundingClientRect().top;if(x(this,D)[D].scrollOffsetElement){const e=document.querySelector(x(this,D)[D].scrollOffsetElement);e&&(r-=e.clientHeight)}window.scrollTo({top:r,behavior:"smooth"})}function oe(e){const t=document.querySelector(x(this,D)[D].scrollOffsetElement);let o=0;t&&(o=t.clientHeight);const r=e.getBoundingClientRect();return r.top>=o&&r.left>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&r.right<=(window.innerWidth||document.documentElement.clientWidth)}new g(new I,new K)}();
//# sourceMappingURL=ajax-form.min.js.map